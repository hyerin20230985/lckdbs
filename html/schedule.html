<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/schedule-styles.css">
    <title>LCK íŒ€ ë° ì„ ìˆ˜ ëª©ë¡</title>

</head>
<body>
    <header class="header_container__2I4IR" id="header" data-app-status="false" data-fixed="true">
        <div class="header_menu__23d4_">
            <ul class="sub_menu_list__3LmV1">
                <li class="sub_menu_item__Q2d1m"><a href="/esports/League_of_Legends/home" class="sub_menu_link__3BySZ">í™ˆ</a></li>
                <li class="sub_menu_item__Q2d1m"><a href="/esports/League_of_Legends/board" class="sub_menu_link__3BySZ">ì»¤ë®¤ë‹ˆí‹°</a></li>
                <li class="sub_menu_item__Q2d1m"><a href="/esports/League_of_Legends/board/gametalk/2025031617NWRPFZ04564lol" class="sub_menu_link__3BySZ">ê²½ê¸°</a></li>
                <li class="sub_menu_item__Q2d1m"><a href="/esports/League_of_Legends/news/lol" class="sub_menu_link__3BySZ">ë‰´ìŠ¤</a></li>
                <li class="sub_menu_item__Q2d1m"><a href="/esports/League_of_Legends/schedule/first_stand_lol" class="sub_menu_link__3BySZ" data-active="true">ì¼ì •</a></li>
                <li class="sub_menu_item__Q2d1m"><a href="/esports/League_of_Legends/videos/league/first_stand_lol" class="sub_menu_link__3BySZ">ì˜ìƒ</a></li>
                <li class="sub_menu_item__Q2d1m"><a href="/esports/League_of_Legends/record" class="sub_menu_link__3BySZ">ìˆœìœ„</a></li>
                <li class="sub_menu_item__Q2d1m"><a href="/esports/League_of_Legends/prediction" class="sub_menu_link__3BySZ">ìŠ¹ë¶€ì˜ˆì¸¡</a></li>
            </ul>
        </div>
    </header>

    <main>
        <div class="schedule_container">
            <h2>ëŒ€íšŒ ì¼ì •</h2>
            <div class="tournament_selector">
                <label for="tournamentSelect">ëŒ€íšŒ ì„ íƒ:</label>
                <select id="tournamentSelect" onchange="updateSchedule(new Date($('#dateSelect').val()), this.value)">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="í¼ìŠ¤íŠ¸ ìŠ¤íƒ ë“œ í† ë„ˆë¨¼íŠ¸">í¼ìŠ¤íŠ¸ ìŠ¤íƒ ë“œ í† ë„ˆë¨¼íŠ¸</option>
                    <option value="LCK">LCK</option>
                    <option value="MSI">MSI</option>
                    <option value="ë¡¤ë“œì»µ">ë¡¤ë“œì»µ</option>
                </select>
            </div>
            <div class="year_selector">
                <label for="dateSelect">ë‚ ì§œ ì„ íƒ:</label>
                <input type="text" id="dateSelect" class="date_select" placeholder="ë‚ ì§œë¥¼ ì„ íƒí•˜ì„¸ìš”">
                <i class="calendar_icon" onclick="$('#dateSelect').datepicker('show');">ğŸ“…</i>
            </div>
            <div class="schedule_list" id="scheduleList"></div>
        </div>
    </main>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    
    <script>
        let scrollPosition = 0; // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ ì €ì¥í•  ë³€ìˆ˜
        let statPageIdCounter = 0; // statPageIdë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ counter

        $(function() {
            $('#dateSelect').datepicker({
                dateFormat: 'yy-mm-dd',
                onSelect: function(dateText) {
                    const selectedDate = new Date(dateText);
                    const tournament = document.getElementById('tournamentSelect').value;
                    if (tournament) {
                        updateSchedule(selectedDate, tournament); // ì„ íƒí•œ ë‚ ì§œì™€ ëŒ€íšŒë¡œ ì¼ì • ì—…ë°ì´íŠ¸
                    }
                }
            });
        });
    
        const schedules = {
            'í¼ìŠ¤íŠ¸ ìŠ¤íƒ ë“œ í† ë„ˆë¨¼íŠ¸': [
                { date: '2025-03-10', time: '17:00', round: '1ë¼ìš´ë“œ', team1: 'Team Liquid', team1Player: '/photos/players/umti.jpg', team1Logo: '/photos/assets/team liquid.png', team2: 'Karmine Corp', team2Logo: '/photos/assets/karmine corp.png', team2Player: '/photos/players/canna.jpg', score: '2 : 1', link: 'https://game.naver.com/esports/League_of_Legends/videos/1044679' },
                { date: '2025-03-10', time: '20:00', round: '1ë¼ìš´ë“œ', team1: 'í•œí™”ìƒëª… EìŠ¤í¬ì¸ ', team1Player: '/photos/players/zeus.jpg', team1Logo: '/photos/assets/HLE.svg', team2: 'TOP E-sports', team2Logo: '/photos/assets/top esports.png', team2Player: '/photos/players/369.jpg', score: '2 : 0', link: 'https://game.naver.com/esports/League_of_Legends/videos/1044684' },
            ],
            'LCK': [
                { date: '2025-04-15', time: '18:00', round: 'ì •ê·œ ì‹œì¦Œ', team1: 'T1', team1Player: '/photos/players/faker.jpg', team1Logo: '/photos/assets/t1.png', team2: 'Gen.G', team2Logo: '/photos/assets/gen.g.svg', team2Player: '/photos/players/chovy.jpg', score: '3 : 1', link: 'https://game.naver.com/esports/League_of_Legends/videos/1044690' },
            ],
            'MSI': [
                { date: '2025-05-05', time: '19:00', round: 'ê·¸ë£¹ ìŠ¤í…Œì´ì§€', team1: 'DWG KIA', team1Player: '/photos/players/showmaker.jpg', team1Logo: '/photos/assets/dk.svg', team2: 'T1', team2Logo: '/photos/assets/T1.png', team2Player: '/photos/players/FAKER.jpg', score: '3 : 2', link: 'https://game.naver.com/esports/League_of_Legends/videos/1044695' },
            ],
            'ë¡¤ë“œì»µ': [
                { date: '2025-10-10', time: '17:00', round: '8ê°•', team1: 'T1', team1Player: '/photos/players/FAKER.jpg', team1Logo: '/photos/assets/T1.png', team2: 'DWG KIA', team2Logo: '/photos/assets/2022 DK.svg', team2Player: '/photos/players/showmaker.jpg', score: '3 : 1', link: 'https://game.naver.com/esports/League_of_Legends/videos/1044700' },
            ],
        };

function updateSchedule(selectedDate, tournament) {
    const scheduleList = document.getElementById('scheduleList');
    scheduleList.innerHTML = '';

    if (!selectedDate || !tournament) {
        return;
    }

    const selectedDateString = selectedDate.toISOString().split('T')[0];
    const now = new Date();

    schedules[tournament].forEach(schedule => {
        if (schedule.date === selectedDateString) {
            const matchDateTime = new Date(`${schedule.date}T${schedule.time}`);
            const isEnded = now > matchDateTime ? 'ì¢…ë£Œ' : '';
            const status = isEnded ? '<span class="status">ì¢…ë£Œ</span>' : '';

            // statPageId ìƒì„±
            const statPageId = `statPage-${statPageIdCounter++}`;

            const scheduleItem = document.createElement('div');
            scheduleItem.className = 'schedule_item';
            scheduleItem.dataset.statPageId = statPageId; // statPageIdë¥¼ schedule_itemì— ì €ì¥
           scheduleItem.dataset.tournament = tournament;  // ğŸ”¥ ì¶”ê°€
            scheduleItem.dataset.date = schedule.date;     // ğŸ”¥ ì¶”ê°€
            scheduleItem.innerHTML = `
                <span class="schedule_time">${schedule.time} ${status}</span>
                <span class="schedule_round">${schedule.round}</span>
                <div class="schedule_team">
                    <div class="team_info">
                        <img src="${schedule.team1Player}" alt="${schedule.team1} ì„ ìˆ˜" class="player_photo">
                        <img src="${schedule.team1Logo}" alt="${schedule.team1} ë¡œê³ " class="team_logo">
                        <span class="team_name">${schedule.team1}</span>
                    </div>
                    <div class="schedule_score">
                        <span class="win">${schedule.score.split(':')[0]}</span> 
                        vs 
                        <span class="lose">${schedule.score.split(':')[1]}</span>
                    </div>
                    <div class="team_info">
                        <span class="team_name">${schedule.team2}</span>
                        <img src="${schedule.team2Logo}" alt="${schedule.team2} ë¡œê³ " class="team_logo">
                        <img src="${schedule.team2Player}" alt="${schedule.team2} ì„ ìˆ˜" class="player_photo">
                    </div>
                </div>
                <a href="${schedule.link}" class="more_info" target="_blank">ë‹¤ì‹œë³´ê¸°</a>
            `;
            scheduleList.appendChild(scheduleItem);

            // stat-page-container ìƒì„± ë° ì¶”ê°€
            const statPageContainer = document.createElement('div');
            statPageContainer.className = 'stat-page-container';
            statPageContainer.id = statPageId; // statPageIdë¥¼ idë¡œ ì„¤ì •
    
            scheduleList.appendChild(statPageContainer);
        }
    });
}

$(document).ready(function() {
    $('#scheduleList').on('click', '.schedule_item', function() {
        const statPageContainerId = $(this).data('stat-page-id');
        const statPageContainer = $('#' + statPageContainerId);

        // statPageContainerê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.
        if (!statPageContainer.length) {
            console.error('Stat page container not found with id:', statPageContainerId);
            return;
        }

        const isVisible = statPageContainer.hasClass('show');

        if (!isVisible) {
            // ìŠ¤íƒ¯ í˜ì´ì§€ê°€ ìˆ¨ê²¨ì ¸ ìˆëŠ” ê²½ìš°
            statPageContainer.addClass('show'); // ìŠ¤íƒ¯ í˜ì´ì§€ í‘œì‹œ

            // ë‚´ìš©ì´ ë¹„ì–´ìˆì„ ë•Œë§Œ AJAX ìš”ì²­
            if (statPageContainer.html() === '') {
                const tournament = $(this).data('tournament');
                const date = $(this).data('date');

                $.ajax({
                    url: `stat.html?tournament=${tournament}&date=${date}`, // ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¶”ê°€
                    dataType: 'html',
                    success: function (data) {
                        statPageContainer.html(data);
                    },
                    error: function (xhr, status, error) {
                        console.error("Error loading stat-page.html:", status, error);
                        statPageContainer.html(`<p>Failed to load stats. Error: ${status} - ${error}</p>`);
                    }
                });
            }
        } else {
            // ìŠ¤íƒ¯ í˜ì´ì§€ê°€ ì´ë¯¸ í‘œì‹œëœ ê²½ìš°
            statPageContainer.removeClass('show'); // ìŠ¤íƒ¯ í˜ì´ì§€ ìˆ¨ê¹€
            // statPageContainer.html(''); // ìŠ¤íƒ¯ í˜ì´ì§€ ì»¨í…Œì´ë„ˆ ë‚´ìš© ì´ˆê¸°í™” (ìœ ì§€)
        }
    });
});


</script>
</body>

</html>
